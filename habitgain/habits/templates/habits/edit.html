{% extends "base.html" %}
{% block content %}
<div class="container-form py-4" style="max-width: 720px; margin: auto;">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h1 class="fw-bold mb-1">Editar hábito</h1>
      <p class="text-muted mb-0">Modifica el nombre, la descripción, la frecuencia o la categoría</p>
    </div>
    <span class="brand-badge">✦</span>
  </div>

  {% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
  {% for category, message in messages %}
  <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
    {{ message }}
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
  </div>
  {% endfor %}
  {% endif %}
  {% endwith %}

  <div class="card glass p-4">
    <form method="POST" action="{{ url_for('habits.edit', habit_id=habit.id) }}">
      <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />

      <div class="mb-3">
        <label class="form-label fw-semibold">Nombre *</label>
        <input class="form-control p-3" type="text" name="name" value="{{ habit.name }}" required />
      </div>

      <div class="mb-3">
        <label class="form-label fw-semibold">Descripción</label>
        <textarea class="form-control p-3" rows="3" name="short_desc" placeholder="Descripción corta">{{ habit.short_desc }}</textarea>
      </div>

      <div class="row g-3">
        <div class="col-md-6">
          <label class="form-label fw-semibold">Frecuencia</label>
          <select class="form-select p-3" name="frequency">
            {% set freq = habit.frequency or 'daily' %}
            <option value="daily" {{ 'selected' if freq=='daily' else '' }}>Diaria</option>
            <option value="weekly" {{ 'selected' if freq=='weekly' else '' }}>Semanal</option>
            <option value="monthly" {{ 'selected' if freq=='monthly' else '' }}>Mensual</option>
          </select>
        </div>
        <div class="col-md-6">
          <label class="form-label fw-semibold">Categoría</label>
          <select class="form-select p-3" name="category_id" required>
            {% for c in categories %}
            <option value="{{ c.id }}" {{ 'selected' if c.id==habit.category_id else '' }}>{{ c.name }}</option>
            {% endfor %}
          </select>
        </div>
      </div>

      <div class="d-flex gap-2 justify-content-end mt-4">
        <a href="{{ url_for('progress.panel') }}" class="btn btn-outline-secondary rounded-pill px-4">Cancelar</a>
        <button type="submit" class="btn btn-primary rounded-pill px-4">Guardar cambios</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}
